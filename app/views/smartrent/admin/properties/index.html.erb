<% content_for(:ui_west) do %>
  <%= render "filter_form" %>
<% end %>

<% content_for(:ui_center) do %>
  <div class="listing">
    <div class="links pull-right">
      <% if current_user.is_admin? %>
        <%= link_to 'Import Properties', import_admin_properties_path, :class => "btn btn-default", :style => "display:none" %>
        <%= link_to 'New Property', new_admin_property_path, :class => "btn btn-primary" %>
      <% end %>
    </div>
    <h3>Listing Properties</h3>

    <% if @properties.present? %>
      <table class="table">
        <tr>
          <th>Origin ID</th>
          <th>Name</th>
          <th>Description</th>
          <th>Website</th>
          <th width="310px">Actions</th>
        </tr>
      <% @properties.each do |property| %>
        <tr>
          <td><%= property.origin_id %></td>
          <td><%= property.name %></td>
          <td><%= strip_tags(property.description).truncate(27) if property.description %></td>
          <td><%= link_to truncate(property.website_url, :length => 35), property.formatted_website_url, :target => "_blank" %></td>
          <td>
            <%= link_to 'Residents', main_app.property_residents_path(property) %> |
            <%= link_to 'Floorplans', admin_property_floor_plans_path(property) %> |
            <%= link_to 'Show', admin_property_path(property) %> 
            <% if current_user.is_admin? %> |
              <%= link_to 'Edit', edit_admin_property_path(property) %> |
              <%= link_to 'Delete', admin_property_path(property), method: :delete, data: { confirm: 'Are you sure?' } %>
            <% end %>
          </td>
        </tr>
      <% end %>
      </table>
      <div class="paging-info">
        <%= page_entries_info @properties %>
        <%= page_navigation_links @properties %>
      </div>
    <% elsif params[:search] == "1" %>
      <div class="alert alert-warning">No Properties found</div>
    <% else %>
      <div class="alert alert-warning">No Properties have been added yet.</div>
    <% end %>
  </div>
<% end %>


<script type="text/javascript">
  $(function(){
    App.initPageLayout();
  });
</script>
